var tableDataAndGraph;(()=>{"use strict";var e={583:(e,a,t)=>{t.d(a,{w:()=>r});class r{constructor(){}static get_data_cel(){return null}static return_JSON_structure(){return{account:{value:"",position:0},categories:{value:"",position:0},group_account_name:{value:"",position:0},account_name:{value:"",position:0},PreviousYear:{value:"",position:0},Budget:{value:"",position:0},CurrentYear:{value:"",position:0},difDollar:{value:"",position:0},difPercentage:{value:"",position:0},current_date:null}}static return_JSON_simple_structure(){return{categories:"",PreviousYear:0,Budget:0,CurrentYear:0,difDollar:0,difPercentage:0}}}},946:(e,a,t)=>{t.d(a,{C:()=>i,S:()=>u});var r=t(674),l=r.z.Zp,n=r.z.Kx;class o extends l{BackGroundColor=new r.z.sk({name:"BackGroundColor",displayName:"Background Color",value:{value:"#FFFFFF"}});BackGroundColorAccount=new r.z.sk({name:"BackGroundColorAccount",displayName:"Background Color Type Account",value:{value:"#FFFFFF"}});BackGroundColorHeaders=new r.z.sk({name:"BackGroundColorHeaders",displayName:"Background Color Headers",value:{value:"#FFFFFF"}});BackGroundColorHeadersColor=new r.z.sk({name:"BackGroundColorHeadersColor",displayName:"Text Color Headers",value:{value:"#FFFFFF"}});LabelExpenses=new r.z.ks({placeholder:"Label Expenses",name:"LabelExpenses",displayName:"Label Expenses",value:"Label Expense"});LabelIncome=new r.z.ks({placeholder:"Label Income",name:"LabelIncome",displayName:"Label Income",value:"Label Income"});LabelTotalExpenses=new r.z.ks({placeholder:"Label Total Expenses",name:"LabelTotalExpenses",displayName:"Label Total Expenses",value:"Label Expense"});LabelTotalIncome=new r.z.ks({placeholder:"Label Total Income",name:"LabelTotalIncome",displayName:"Label Total Income",value:"Label Total Income"});LabelTotalProfit=new r.z.ks({placeholder:"Label Total Profit",name:"LabelTotalProfit",displayName:"Label Total Profit",value:"Label Total Profit"});LabelRevenues=new r.z.ks({placeholder:"Label NON-Operatin Revenues",name:"LabelRevenues",displayName:"Label NON-Operatin Revenues",value:"Label NON-Operatin Revenues"});LabelTotalRevenues=new r.z.ks({placeholder:"Label Total NON-Operatin Revenues",name:"LabelTotalRevenues",displayName:"Label Total NON-Operatin Revenues",value:"Label Total NON-Operatin Revenues"});LabelTotalNetResultOperation=new r.z.ks({placeholder:"Label Total Net Result Operation",name:"LabelTotalNetResultOperation",displayName:"Label Total Net Result Operation",value:"Label Total Net Result Operation"});DecimalPlaces=new r.z.iB({name:"DecimalPlaces",displayName:"Decimal Place",value:2,options:{minValue:{type:0,value:0},maxValue:{type:1,value:8}}});name="format_table";displayName="Format Table";slices=[this.LabelIncome,this.LabelTotalIncome,this.LabelExpenses,this.LabelTotalExpenses,this.BackGroundColorHeaders,this.BackGroundColorHeadersColor,this.BackGroundColor,this.DecimalPlaces,this.BackGroundColorAccount,this.LabelTotalProfit,this.LabelRevenues,this.LabelTotalRevenues,this.LabelTotalNetResultOperation]}class u extends n{dataPointCard=new o;cards=[this.dataPointCard]}class i{INCOME;EXPENSES;PROFIT;REVENUES;NETRESULTOPERATION;DecimalPlaces;BackGroundColor;BackGroundColorAccount;BackGroundColorHeaders;BackGroundColorHeadersColor;constructor(e=null,a=null,t=null,r=null,l=null,n=2,o="#FFFFFF",u="#FFFFFF",i="#FFFFFF",s="#FFFFFF"){this.INCOME=e,this.EXPENSES=a,this.PROFIT=t,this.REVENUES=r,this.NETRESULTOPERATION=l,this.DecimalPlaces=n,this.BackGroundColor=o,this.BackGroundColorAccount=u,this.BackGroundColorHeaders=i,this.BackGroundColorHeadersColor=s}getSettings(e){return console.log("*****************[_SETTINGS_]********************"),console.info("******["+JSON.stringify(e)+"]*******"),{INCOME:{Label:e.dataPointCard.LabelIncome.value,LabelTotal:e.dataPointCard.LabelTotalIncome.value},EXPENSES:{Label:e.dataPointCard.LabelExpenses.value,LabelTotal:e.dataPointCard.LabelTotalExpenses.value},PROFIT:{Label:null,LabelTotal:e.dataPointCard.LabelTotalProfit.value},REVENUES:{Label:e.dataPointCard.LabelRevenues.value,LabelTotal:e.dataPointCard.LabelTotalRevenues.value},NETRESULTOPERATION:{Label:e.dataPointCard.LabelTotalNetResultOperation.value,LabelTotal:e.dataPointCard.LabelTotalNetResultOperation.value},DecimalPlaces:e.dataPointCard.DecimalPlaces.value,BackGroundColor:e.dataPointCard.BackGroundColor.value.value,BackGroundColorAccount:e.dataPointCard.BackGroundColorAccount.value.value,BackGroundColorHeaders:e.dataPointCard.BackGroundColorHeaders.value.value,BackGroundColorHeadersColor:e.dataPointCard.BackGroundColorHeadersColor.value.value}}}},283:(e,a,t)=>{t.d(a,{b:()=>o});var r=t(583),l=t(674),n=t(946);class o{static consoleBox;static target;updateCount;textNode;AllColumnNames;executeUpdate;table;formattingSettings;formattingSettingsService;dataView;static _id_event_click_global_="";static GrandTotal={INCOME:r.w.return_JSON_structure(),EXPENSES:r.w.return_JSON_structure(),PROFIT:r.w.return_JSON_structure(),REVENUES:r.w.return_JSON_structure(),NETRESULTOPERATION:r.w.return_JSON_structure(),ITDA_VALUE:r.w.return_JSON_structure(),EBITDA_VALUE:r.w.return_JSON_structure(),EBITDA_PERCENTAGE:r.w.return_JSON_structure()};static settings_obj;constructor(e){if(this.formattingSettingsService=new l.O,o.target=e.element,this.executeUpdate=!1,document){const e=document.createElement("div");e.className="TblContainerER",e.setAttribute("id","TblContainerER"),o.target.appendChild(e)}}static getCurrentLine(){const e=new Error,a=(e.stack?.split("\n")||[])[2].match(/:(\d+):\d+/);return a?parseInt(a[1],10):-1}static ReturnCell(e,a,t="",r=null){const l=document.createElement(e);return l.innerHTML=a,""!=t&&(l.className=t),null!==r&&l.setAttribute("colspan",r.toString()),l}ExistPropierty(e,a=null){return null!==a?!("object"!=typeof e||null===e||!e.hasOwnProperty(a)||void 0===e):null!=e}static checkValue(e,a=!1,t=""){return null==e||null==e?t:a?Number(e):e}static returnDate(e){return`${e.getDate().toString()}-${(e.getMonth()+1).toString()}-${e.getFullYear()}`}static ReplaceYTD(e,a,t){return e.replace("[CURRENT YEAR]",t).replace("[LAST YEAR]",a).replace(/\s+/g,"<br>")}onlyUnique(e,a,t){return t.indexOf(e)===a}static getRowValuesJson(e,a){return{account:e[a.account.position],categories:e[a.categories.position],group_account_name:e[a.group_account_name.position],account_name:e[a.account_name.position],PreviousYear:Number(e[a.PreviousYear.position]),Budget:Number(e[a.Budget.position]),CurrentYear:Number(e[a.CurrentYear.position]),difDollar:Number(e[a.difDollar.position]),difPercentage:Number(e[a.difPercentage.position])}}returnDB_Json(e){const a={TITLE_COLUMNS:{VALUES:[r.w.return_JSON_structure()]},VALUES:[],INCOME:{VALUES:[]},EXPENSES:{VALUES:[]},PROFIT:{VALUES:[]},REVENUES:{VALUES:[]},NETRESULTOPERATION:{VALUES:[]},CURRENT_YTD:"",LAST_YTD:""};return e.columns.forEach((e=>{const t={value:JSON.stringify(e.displayName),position:parseInt(e.index)};e.roles.hasOwnProperty("account")?a.TITLE_COLUMNS.VALUES[0].account=t:e.roles.hasOwnProperty("categories")?a.TITLE_COLUMNS.VALUES[0].categories=t:e.roles.hasOwnProperty("group_account_name")?a.TITLE_COLUMNS.VALUES[0].group_account_name=t:e.roles.hasOwnProperty("account_name")?a.TITLE_COLUMNS.VALUES[0].account_name=t:e.roles.hasOwnProperty("PreviousYear")?a.TITLE_COLUMNS.VALUES[0].PreviousYear=t:e.roles.hasOwnProperty("Budget")?a.TITLE_COLUMNS.VALUES[0].Budget=t:e.roles.hasOwnProperty("CurrentYear")?a.TITLE_COLUMNS.VALUES[0].CurrentYear=t:e.roles.hasOwnProperty("difDollar")?a.TITLE_COLUMNS.VALUES[0].difDollar=t:e.roles.hasOwnProperty("difPercentage")?a.TITLE_COLUMNS.VALUES[0].difPercentage=t:e.roles.hasOwnProperty("current_date")&&(a.TITLE_COLUMNS.VALUES[0].current_date=t)})),e.rows.forEach((e=>{let t="";if(null!==e[a.TITLE_COLUMNS.VALUES[0].categories.position]){t=e[a.TITLE_COLUMNS.VALUES[0].account.position];const r=o.getRowValuesJson(e,a.TITLE_COLUMNS.VALUES[0]);"FINANCIAL/DEPRECIATION"===r.categories&&(r.account_name.toUpperCase().includes("Amortizations".toUpperCase())||r.account_name.toUpperCase().includes("Depreciation".toUpperCase())||r.account_name.toUpperCase().includes("Interest Payment".toUpperCase()))&&(o.GrandTotal.ITDA_VALUE.categories.value="EBITDA (US$)",o.GrandTotal.ITDA_VALUE.PreviousYear.value=Number(o.GrandTotal.ITDA_VALUE.PreviousYear.value)+Number(r.PreviousYear),o.GrandTotal.ITDA_VALUE.Budget.value=Number(o.GrandTotal.ITDA_VALUE.Budget.value)+Number(r.Budget),o.GrandTotal.ITDA_VALUE.CurrentYear.value=Number(o.GrandTotal.ITDA_VALUE.CurrentYear.value)+Number(r.CurrentYear),o.GrandTotal.ITDA_VALUE.difDollar.value=Number(o.GrandTotal.ITDA_VALUE.difDollar.value)+Number(r.difDollar),o.GrandTotal.ITDA_VALUE.difPercentage.value=Number(o.GrandTotal.ITDA_VALUE.difPercentage.value)+Number(r.difPercentage)),"OPERATING INCOME"==t?a.INCOME.VALUES.push(r):"OPERATING EXPENSES"==t?a.EXPENSES.VALUES.push(r):"NON-OPERATING REVENUES"==t&&a.REVENUES.VALUES.push(r)}""==a.CURRENT_YTD&&(a.CURRENT_YTD=o.returnFormatYTD(e[a.TITLE_COLUMNS.VALUES[0].current_date.position],"current"),a.LAST_YTD=o.returnFormatYTD(e[a.TITLE_COLUMNS.VALUES[0].current_date.position],"last"),a.TITLE_COLUMNS.VALUES[0].account.value=o.ReplaceYTD(a.TITLE_COLUMNS.VALUES[0].account.value,a.LAST_YTD,a.CURRENT_YTD),a.TITLE_COLUMNS.VALUES[0].PreviousYear.value=o.ReplaceYTD(a.TITLE_COLUMNS.VALUES[0].PreviousYear.value,a.LAST_YTD,a.CURRENT_YTD),a.TITLE_COLUMNS.VALUES[0].Budget.value=o.ReplaceYTD(a.TITLE_COLUMNS.VALUES[0].Budget.value,a.LAST_YTD,a.CURRENT_YTD),a.TITLE_COLUMNS.VALUES[0].CurrentYear.value=o.ReplaceYTD(a.TITLE_COLUMNS.VALUES[0].CurrentYear.value,a.LAST_YTD,a.CURRENT_YTD),a.TITLE_COLUMNS.VALUES[0].difDollar.value=o.ReplaceYTD(a.TITLE_COLUMNS.VALUES[0].difDollar.value,a.LAST_YTD,a.CURRENT_YTD),a.TITLE_COLUMNS.VALUES[0].difPercentage.value=o.ReplaceYTD(a.TITLE_COLUMNS.VALUES[0].difPercentage.value,a.LAST_YTD,a.CURRENT_YTD))})),a}static isNumeric(e){return null!=e&&""!==e&&!isNaN(Number(e.toString()))}static returnFormatYTD(e,a="current"){const t="current"==a?2e3:2001;return(new Date(e).toLocaleString("default",{month:"short"})+"-"+(parseInt(new Date(e).toLocaleString("default",{year:"numeric"}))-t)).replace(/^\w/,(e=>e.toUpperCase()))}static returnStyleOutput(e,a=null,t=!0){if(e=o.isNumeric(e)?o.PrintFormatNumeric(e,!1,!1,t):e,null===a)return"<span>"+e+"</span>";if("$"==a||"U$"==a||"US$"==a||"C$"==a)return"<span><i>"+a+"</i>"+(e+""=="-0"?"-":e)+"</span>";if("%"==a){const a=parseFloat(e.replace("(","-").replace(")",""));return Number.isNaN(a)?"<span>-</span>":"<span>"+a.toFixed(1)+"%</span>"}}static capitalizar(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}static ReturnRowWithData(e,a=null){const t=document.createElement("tr");"is_row_category"===a?(null!=a&&(t.className=a+" "+o._id_event_click_global_,t.setAttribute("data-category",o.doDashes(e.categories))),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.categories),"is_string"))):"is_row_group_acount"===a?(null!=a&&(t.className=a+" "+o._id_event_click_global_,t.setAttribute("data-group-acount",o.doDashes(e.group_account_name))),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.group_account_name),"is_string"))):(t.className=a+" hidden "+o.doDashes(e.categories),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.account_name),"is_string "))),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.PreviousYear,"$"),"is_numeric")),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.Budget,"$"),"is_numeric")),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.CurrentYear,"$"),"is_numeric")),t.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.difDollar,"$"),"is_numeric"));const r=o.returnStyleOutput(Number(e.Budget)>0?Number(e.difDollar)/Number(e.Budget)*100:"-","%",!1);return t.appendChild(o.ReturnCell("td","<span>-%</span>"==r?"<span></span>":r,"is_numeric")),t}static doDashes(e){return(e=e.replace(/[^a-z0-9]+/gi,"-")).replace(/^-*|-*$/g,"").toLowerCase()}static getRandomArbitrary(e,a){return(Math.random()*(a-e)+e).toFixed(0)}static returnTotalLabel(e){let a="";switch(e){case"PROFIT":a="PROFIT";break;case"NETRESULTOPERATION":a="NETRESULTOPERATION";break;case"EBITDA_VALUE":a="EBITDA_VALUE";break;case"EBITDA_PERCENTAGE":a="EBITDA_PERCENTAGE";break;default:a=e}return a}static returnJsonEBITDA_VALUE(){const e=Number(o.GrandTotal.INCOME.PreviousYear.value),a=Number(o.GrandTotal.EBITDA_VALUE.PreviousYear.value),t=Number(o.GrandTotal.INCOME.Budget.value),r=Number(o.GrandTotal.EBITDA_VALUE.Budget.value),l=Number(o.GrandTotal.INCOME.CurrentYear.value),n=Number(o.GrandTotal.EBITDA_VALUE.CurrentYear.value),u=100*(0==l?0:n/l),i=100*(0==t?0:r/t),s=u-i;return{account:{value:"",position:0},categories:{value:"",position:0},group_account_name:{value:"",position:0},PreviousYear:{value:a/e*100,position:0},Budget:{value:i,position:0},CurrentYear:{value:u,position:0},difDollar:{value:s,position:0},difPercentage:{value:0==i?0:s/i,position:0}}}static ClearDataValues(e=null){o.GrandTotal[e].categories.value="",o.GrandTotal[e].PreviousYear.value=0,o.GrandTotal[e].Budget.value=0,o.GrandTotal[e].CurrentYear.value=0,o.GrandTotal[e].difDollar.value=0,o.GrandTotal[e].difPercentage.value=0}static SetDataValue(e=null,a=null){o.GrandTotal[e].categories.value=a.categories,o.GrandTotal[e].PreviousYear.value=a.PreviousYear,o.GrandTotal[e].Budget.value=a.Budget,o.GrandTotal[e].CurrentYear.value=a.CurrentYear,o.GrandTotal[e].difDollar.value=a.difDollar,o.GrandTotal[e].difPercentage.value=a.difPercentage}static UpdateDataValues(e=null,a=null){null!==e&&null!==a&&("INCOME"===e?(a.categories="OPERATING INCOME",o.SetDataValue("INCOME",a)):"EXPENSES"===e?(a.categories="OPERATING EXPENSES",o.SetDataValue("EXPENSES",a),o.GrandTotal.PROFIT.categories.value="PROFIT OPERATION",o.GrandTotal.PROFIT.PreviousYear.value=o.GrandTotal.INCOME.PreviousYear.value-o.GrandTotal.EXPENSES.PreviousYear.value,o.GrandTotal.PROFIT.Budget.value=o.GrandTotal.INCOME.Budget.value-o.GrandTotal.EXPENSES.Budget.value,o.GrandTotal.PROFIT.CurrentYear.value=o.GrandTotal.INCOME.CurrentYear.value-o.GrandTotal.EXPENSES.CurrentYear.value,o.GrandTotal.PROFIT.difDollar.value=o.GrandTotal.INCOME.difDollar.value-o.GrandTotal.EXPENSES.difDollar.value,o.GrandTotal.PROFIT.difPercentage.value=o.GrandTotal.INCOME.difPercentage.value-o.GrandTotal.EXPENSES.difPercentage.value):"REVENUES"===e&&(a.categories="NON-OPERATING REVENUES",o.SetDataValue("REVENUES",a),o.GrandTotal.NETRESULTOPERATION.categories.value="NET RESULT OPERATION",o.GrandTotal.NETRESULTOPERATION.PreviousYear.value=o.GrandTotal.PROFIT.PreviousYear.value+o.GrandTotal.REVENUES.PreviousYear.value,o.GrandTotal.NETRESULTOPERATION.Budget.value=o.GrandTotal.PROFIT.Budget.value+o.GrandTotal.REVENUES.Budget.value,o.GrandTotal.NETRESULTOPERATION.CurrentYear.value=o.GrandTotal.PROFIT.CurrentYear.value+o.GrandTotal.REVENUES.CurrentYear.value,o.GrandTotal.NETRESULTOPERATION.difDollar.value=o.GrandTotal.PROFIT.difDollar.value+o.GrandTotal.REVENUES.difDollar.value,o.GrandTotal.NETRESULTOPERATION.difPercentage.value=o.GrandTotal.PROFIT.difPercentage.value+o.GrandTotal.REVENUES.difPercentage.value))}static ReturnGroupedRow(e=null,a=null){return null===e?{account:"",categories:"",group_account_name:"",PreviousYear:0,Budget:0,CurrentYear:0,difDollar:0,difPercentage:0}:null===a?{account:e.account,categories:e.categories,group_account_name:e.group_account_name,PreviousYear:e.PreviousYear,Budget:e.Budget,CurrentYear:e.CurrentYear,difDollar:e.difDollar,difPercentage:e.difPercentage}:{account:e.account,categories:e.categories,group_account_name:e.group_account_name,PreviousYear:e.PreviousYear+a.PreviousYear,Budget:e.Budget+a.Budget,CurrentYear:e.CurrentYear+a.CurrentYear,difDollar:e.difDollar+a.difDollar,difPercentage:e.difPercentage+a.difPercentage}}static CreateRowHTML(e=null,a="",t="$"){const r=document.createElement("tr");return r.className=a,null!==e&&(r.appendChild(o.ReturnCell("th",o.returnStyleOutput(e.categories.value),"is_string_full")),r.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.PreviousYear.value,t),"is_numeric")),r.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.Budget.value,t),"is_numeric")),r.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.CurrentYear.value,t),"is_numeric")),r.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.difDollar.value,t),"is_numeric")),r.appendChild(o.ReturnCell("td",o.returnStyleOutput(e.difPercentage.value,"%",!1),"is_numeric"))),r}static GenerateAccountTypeTable(e=null,a=null,t=null){let r=document.createElement("table"),l=document.createElement("thead"),n=document.createElement("tfoot"),u=document.createElement("tbody"),i=document.createElement("tr");if(i.className="is_row_title_type_account",r.className="tbl_style separator-bottom "+e,"PROFIT"==e||"NETRESULTOPERATION"==e||"EBITDA_VALUE"==e||"EBITDA_PERCENTAGE"==e){let a=o.returnTotalLabel(e),t=0==o.GrandTotal[a].Budget.value?0:((o.GrandTotal[a].CurrentYear.value-o.GrandTotal[a].Budget.value)/o.GrandTotal[a].Budget.value*100).toFixed(1);if("EBITDA_PERCENTAGE"===e){let e=o.returnJsonEBITDA_VALUE();e.categories.value=o.GrandTotal[a].categories.value,l.appendChild(o.CreateRowHTML(e,"is_row_title_type_account","%"))}else o.GrandTotal[a].difPercentage.value=t,l.appendChild(o.CreateRowHTML(o.GrandTotal[a],"is_row_title_type_account","$"));r.append(l)}else{let s=o.ReturnGroupedRow(),c="",d=o.ReturnGroupedRow();if(null!==t){r.className="tbl_style","HEADERS"===e&&(i.className="headers");for(let a in t)if("HEADERS"===e&&"account_name"!=a&&"categories"!=a&&"current_date"!=a){const e=t[a].replace('"',"").replace('"',"");i.appendChild(o.ReturnCell("th",e))}l.appendChild(i),r.append(l)}else{if(r.className="tbl_style separator-bottom",null!=o.settings_obj[e].Label){let a=document.createElement("tr");a.className="is_row_title_type_account",a.appendChild(o.ReturnCell("th",o.returnStyleOutput(o.settings_obj[e].Label),"is_string_full",6)),l.appendChild(a)}if(a){let t=o.ReturnGroupedRow(),r=document.createElement("div"),l="",n="",i="";a.forEach(((a,T)=>{""==l&&(l=a.group_account_name,n=" begin_group_"+o.doDashes(a.group_account_name)+" ",i=" class_parent_"+o.doDashes(a.group_account_name)+" "),l!==a.group_account_name?(n=" begin_group_"+o.doDashes(a.group_account_name)+" ",i=" class_parent_"+o.doDashes(a.group_account_name)+" ",l=a.group_account_name,t=o.ReturnGroupedRow(a)):t=o.ReturnGroupedRow(t,a),c!=a.categories&&(""!=c&&(u.appendChild(o.ReturnRowWithData(d,"is_row_category")),u.innerHTML+=r.innerHTML,r.innerHTML=null,s.categories=o.settings_obj[e].LabelTotal,s=o.ReturnGroupedRow(s,d),d=o.ReturnGroupedRow()),r=document.createElement("div")),d.categories=a.categories,d=o.ReturnGroupedRow(d,a),r.appendChild(o.ReturnRowWithData(a,"is_row_title "+n+" "+i)),c=a.categories,n=""})),s.categories=o.settings_obj[e].LabelTotal,s=o.ReturnGroupedRow(s,d),u.appendChild(o.ReturnRowWithData(d,"is_row_category")),u.innerHTML+=r.innerHTML,r.innerHTML=null}if(null!=o.settings_obj[e].Label){let a=document.createElement("tr");a.className="is_row_title_type_account",s.categories=o.settings_obj[e].LabelTotal,s.difPercentage=0==s.Budget?0:((s.CurrentYear-s.Budget)/s.Budget*100).toFixed(1),a.appendChild(o.ReturnCell("th",o.returnStyleOutput(o.settings_obj[e].LabelTotal),"is_string_full")),a.appendChild(o.ReturnCell("td",o.returnStyleOutput(s.PreviousYear,"$"),"is_numeric")),a.appendChild(o.ReturnCell("td",o.returnStyleOutput(s.Budget,"$"),"is_numeric")),a.appendChild(o.ReturnCell("td",o.returnStyleOutput(s.CurrentYear,"$"),"is_numeric")),a.appendChild(o.ReturnCell("td",o.returnStyleOutput(s.difDollar,"$"),"is_numeric")),a.appendChild(o.ReturnCell("td",o.returnStyleOutput(s.difPercentage,"%",!1),"is_numeric")),o.UpdateDataValues(e,s),n.appendChild(a)}r.append(l),r.append(u),r.append(n)}}return r}static GetDataValues(e){return{account:e.account.value,categories:e.categories.value,account_name:e.account_name.value,PreviousYear:e.PreviousYear.value,Budget:e.Budget.value,CurrentYear:e.CurrentYear.value,difDollar:e.difDollar.value,difPercentage:e.difPercentage.value}}InitDataTable(){const e=document.getElementById("TblContainerER");e.innerHTML="";let a=this.dataView.table,t=this.returnDB_Json(a),r=new Date("10/02/2019");const l=new Date;o._id_event_click_global_="event_click_"+Math.abs(r-l)+o.getRandomArbitrary(100,999),e.appendChild(o.GenerateAccountTypeTable("HEADERS",null,o.GetDataValues(t.TITLE_COLUMNS.VALUES[0]))),e.appendChild(o.GenerateAccountTypeTable("INCOME",t.INCOME.VALUES)),e.appendChild(o.GenerateAccountTypeTable("EXPENSES",t.EXPENSES.VALUES)),e.appendChild(o.GenerateAccountTypeTable("PROFIT",t.PROFIT.VALUES)),e.appendChild(o.GenerateAccountTypeTable("REVENUES",t.REVENUES.VALUES)),e.appendChild(o.GenerateAccountTypeTable("NETRESULTOPERATION")),o.GrandTotal.EBITDA_VALUE.categories.value="EBITDA (US$)",o.GrandTotal.EBITDA_VALUE.PreviousYear.value=Number(o.GrandTotal.NETRESULTOPERATION.PreviousYear.value)+Number(o.GrandTotal.ITDA_VALUE.PreviousYear.value),o.GrandTotal.EBITDA_VALUE.Budget.value=Number(o.GrandTotal.NETRESULTOPERATION.Budget.value)+Number(o.GrandTotal.ITDA_VALUE.Budget.value),o.GrandTotal.EBITDA_VALUE.CurrentYear.value=Number(o.GrandTotal.NETRESULTOPERATION.CurrentYear.value)+Number(o.GrandTotal.ITDA_VALUE.CurrentYear.value),o.GrandTotal.EBITDA_VALUE.difDollar.value=Number(o.GrandTotal.NETRESULTOPERATION.difDollar.value)+Number(o.GrandTotal.ITDA_VALUE.difDollar.value),o.GrandTotal.EBITDA_VALUE.difPercentage.value=Number(o.GrandTotal.NETRESULTOPERATION.difPercentage.value)+Number(o.GrandTotal.ITDA_VALUE.difPercentage.value),e.appendChild(o.GenerateAccountTypeTable("EBITDA_VALUE")),o.GrandTotal.EBITDA_PERCENTAGE.categories.value="EBITDA (%)",o.GrandTotal.EBITDA_PERCENTAGE.PreviousYear.value=parseFloat(o.GrandTotal.EBITDA_VALUE.PreviousYear.value+"")/parseFloat(o.GrandTotal.INCOME.PreviousYear.value+""),o.GrandTotal.EBITDA_PERCENTAGE.CurrentYear.value=o.GrandTotal.EBITDA_VALUE.CurrentYear.value/o.GrandTotal.INCOME.CurrentYear.value,o.GrandTotal.EBITDA_PERCENTAGE.difDollar.value=0,o.GrandTotal.EBITDA_PERCENTAGE.difPercentage.value=0,e.appendChild(o.GenerateAccountTypeTable("EBITDA_PERCENTAGE")),o.ClearDataValues("INCOME"),o.ClearDataValues("EXPENSES"),o.ClearDataValues("PROFIT"),o.ClearDataValues("REVENUES"),o.ClearDataValues("NETRESULTOPERATION"),o.ClearDataValues("ITDA_VALUE"),o.ClearDataValues("EBITDA_VALUE"),o.ClearDataValues("EBITDA_PERCENTAGE"),o.target.appendChild(e)}update(e){if(this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(n.S,e.dataViews),o.target){o.settings_obj=(new n.C).getSettings(this.formattingSettings),this.dataView=e.dataViews[0],console.log("WWWWWWWWWWWWWWWWWWWWWWWWWWWw"),console.warn(JSON.stringify(this.dataView)),console.log("WWWWWWWWWWWWWWWWWWWWWWWWWWWw"),this.InitDataTable();let a=$(".TblContainerER").parent();a.css("background",o.settings_obj.BackGroundColor),a.find(".tbl_style tr.headers, .EBITDA_VALUE tr, .EBITDA_PERCENTAGE tr").css("background-color",o.settings_obj.BackGroundColorHeaders),a.find(".tbl_style tr.headers, .EBITDA_VALUE tr, .EBITDA_PERCENTAGE tr").css("color",o.settings_obj.BackGroundColorHeadersColor),a.find(".tbl_style tr.headers th").css("border-color",o.settings_obj.BackGroundColor),a.find(".tbl_style:not(.EBITDA_VALUE, .EBITDA_PERCENTAGE) .is_row_title_type_account").css("background",o.settings_obj.BackGroundColorAccount),$("body").on("click","."+o._id_event_click_global_,(function(){let e=$(this),a=$.trim(e.data("category"));e.hasClass("_show_")?($("tr."+a).addClass("hidden"),e.removeClass("_show_")):($("tr."+a).removeClass("hidden"),e.addClass("_show_"))}))}}static PrintFormatNumeric(e,a=!1,t=!1,r=!0){let l=e,n=Number(o.settings_obj.DecimalPlaces);if(null==l||!isFinite(l))throw new TypeError("number is not valid");a||(a="."),t||(t=","),l=r?parseFloat(l).toFixed(n):parseFloat(l)+"",l=l.replace(".",a);let u=l.split(a);u[0]=u[0].replace(/\B(?=(\d{3})+(?!\d))/g,t),l=u.join(a);let i=(parseFloat(l)<0?"("+l.replace("-","")+")":l).replace("(0)","-");return"0"===i?"-":i}static formatMoney(e,a=2,t=".",r=","){try{a=Math.abs(a),a=isNaN(a)?2:a;const l=e<0?"-":"",n=parseInt(e=Math.abs(Number(e)||0).toFixed(a)).toString(),o=n.length>3?n.length%3:0;return l+(o?n.substr(0,o)+r:"")+n.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+r)+(a?t+Math.abs(e-n).toFixed(a).slice(2):"")}catch(e){return"error"}}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},754:(e,a,t)=>{t.d(a,{Kx:()=>n,Zp:()=>o,iB:()=>s,ks:()=>c,sk:()=>i});var r=t(639);class l{}class n{}class o extends l{getFormattingCard(e,a,t){return{displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,groups:[a],uid:e,analyticsPane:this.analyticsPane}}}class u extends l{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,a){const t=this.type,r=this.name,l={displayName:a&&this.displayNameKey?a.getDisplayName(this.displayNameKey):this.displayName,description:a&&this.descriptionKey?a.getDisplayName(this.descriptionKey):this.description,uid:e+"-"+r};return Object.assign(Object.assign({},l),{control:{type:t,properties:this.getFormattingComponent(e,a)}})}getFormattingComponent(e,a){return{descriptor:r.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,a){var t;let l=null===(t=null==e?void 0:e[a])||void 0===t?void 0:t[this.name];this.value=r.D(this,l,this.value)}}class i extends u{constructor(e){super(e),this.type="ColorPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class s extends u{constructor(e){super(e),this.type="NumUpDown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}class c extends u{constructor(e){super(e),this.type="TextInput"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{placeholder:this.placeholder})}}},667:(e,a,t)=>{t.d(a,{A:()=>r});const r=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,a){var t,r,l;let n=new e,o=null===(r=null===(t=null==a?void 0:a[0])||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.objects;return o&&(null===(l=n.cards)||void 0===l||l.forEach((e=>{var a,t,r;null===(a=null==e?void 0:e.slices)||void 0===a||a.forEach((a=>{null==a||a.setPropertiesValues(o,e.name)})),null===(r=null===(t=null==e?void 0:e.container)||void 0===t?void 0:t.containerItems)||void 0===r||r.forEach((a=>{var t;null===(t=null==a?void 0:a.slices)||void 0===t||t.forEach((a=>{null==a||a.setPropertiesValues(o,e.name)}))}))}))),n}buildFormattingModel(e){var a;let t={cards:[]};return null===(a=e.cards)||void 0===a||a.forEach((e=>{if(!e)return;const a=e.name,r=e.name+"-group";let l={displayName:void 0,slices:[],uid:r},n=e.getFormattingCard(a,l,this.localizationManager);t.cards.push(n);const o={};if(e.container){const t=e.container,u=r+"-container",i={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:this.localizationManager&&t.descriptionKey?this.localizationManager.getDisplayName(t.descriptionKey):t.description,containerItems:[],uid:u};t.containerItems.forEach((e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,r=u+t;let l={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:r};this.buildFormattingSlices(e.slices,a,o,n,l.slices),i.containerItems.push(l)})),l.container=i}e.slices&&this.buildFormattingSlices(e.slices,a,o,n,l.slices),n.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e)})),t}buildFormattingSlices(e,a,t,r,l){null==e||e.forEach((e=>{let n=null==e?void 0:e.getFormattingSlice(a,this.localizationManager);n&&(void 0===t[e.name]?t[e.name]=0:(t[e.name]++,n.uid=`${n.uid}-${t[e.name]}`),e.topLevelToggle?(n.suppressDisplayName=!0,r.topLevelToggle=n):l.push(n))}))}getRevertToDefaultDescriptor(e){var a,t;const r={};let l=[],n=this.getSlicesRevertToDefaultDescriptor(e.name,e.slices,r),o=[];return null===(t=null===(a=e.container)||void 0===a?void 0:a.containerItems)||void 0===t||t.forEach((a=>{o=o.concat(this.getSlicesRevertToDefaultDescriptor(e.name,a.slices,r))})),l=n.concat(o),l}getSlicesRevertToDefaultDescriptor(e,a,t){let r=[];return null==a||a.forEach((a=>{a&&!t[a.name]&&(t[a.name]=!0,r=r.concat(a.getRevertToDefaultDescriptor(e)))})),r}}},674:(e,a,t)=>{t.d(a,{O:()=>l.A,z:()=>r});var r=t(754),l=t(667)},639:(e,a,t)=>{function r(e,a){return{objectName:e,propertyName:a.name,selector:a.selector,altConstantValueSelector:a.altConstantSelector,instanceKind:a.instanceKind}}function l(e,a,t){return null==a||"object"==typeof a&&!a.solid?t:a.solid?{value:null==a?void 0:a.solid.color}:(null==e?void 0:e.items)?e.items.find((e=>e.value==a)):a}t.d(a,{D:()=>l,y:()=>r})}},a={};function t(r){var l=a[r];if(void 0!==l)return l.exports;var n=a[r]={exports:{}};return e[r](n,n.exports,t),n.exports}t.d=(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},t.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{t.r(r),t.d(r,{default:()=>n});var e=t(283),a=window.powerbi,l={name:"tableDataAndGraph",displayName:"table data and graph",class:"Visual",apiVersion:"5.4.0",create:a=>{if(e.b)return new e.b(a);throw"Visual instance not found"},createModalDialog:(e,a,t)=>{const r=globalThis.dialogRegistry;e in r&&new r[e](a,t)},custom:!0};void 0!==a&&(a.visuals=a.visuals||{},a.visuals.plugins=a.visuals.plugins||{},a.visuals.plugins.tableDataAndGraph=l);const n=l})(),tableDataAndGraph=r})();